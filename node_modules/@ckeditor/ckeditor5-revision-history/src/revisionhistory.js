/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x1568=['concat','function','push','Annotations','style','then','data','changesNavigation','getAttributeKeys','fromVersion','includes','addRevisionData','update','initialData','error','getRevisions','parse','selection','getMarkersGroup','refreshPositioning','disableReadOnlyMode','define','uiLanguage','numeric','enableReadOnlyMode','editor','block','_enhanceShowRevisionViewerCallback','revisionHistory.viewerEditorElement','revision-history-viewer-opened','from','document','plugins','locale','Autosave','DocumentOutline','long','RevisionsRepository','_enhanceCloseRevisionViewerCallback','getRevision','revisionHistory.restoreRevisionCallback','_restoreRevision','closeRevisionViewerCallback','getUser','Restored','none','RevisionHistory','catch','model','getRevisionData','exitToEditing','adapter','toVersion','toJSON','RevisionTracker','_update','RestrictedEditingMode','Users','getRootNames','RevisionHistoryUI','save','restrictedEditingException','isAnonymous','name','every','revisionHistory.closeRevisionViewerCallback','revisionHistory.editorContainer','string','toLocaleTimeString','_cleanUp','createdAt','saveRevision','restoreRevision','destroy','removeSelectionAttribute','pluginName','isReadOnly','refreshVisibility','builtinPlugins','removeMarker','_getRevisionViewerEditorConfig','requires','RevisionViewer','extraPlugins','display','indexOf','bind','detachRoot','PaginationLookup','enqueueChange','revision-history-missing-configuration','init','isEnabled','set','repository','names','keys','rootsAttributes','_recalculatePageBreaks','markers','get','revisionHistory.viewerContainer','revisionHistory.showRevisionViewerCallback','_closeRevisionViewer','create','toolbar','_viewerEditor','config','creator','isReady','has','_showRevisionViewer','find','WebSocketGateway','constructor','change'];(function(_0x29a08b,_0x1568b7){const _0x56d84f=function(_0x538372){while(--_0x538372){_0x29a08b['push'](_0x29a08b['shift']());}};_0x56d84f(++_0x1568b7);}(_0x1568,0x113));const _0x56d8=function(_0x29a08b,_0x1568b7){_0x29a08b=_0x29a08b-0x0;let _0x56d84f=_0x1568[_0x29a08b];return _0x56d84f;};import{Plugin as _0x232b46}from'ckeditor5/src/core';import{CKEditorError as _0x4c078a,uid as _0xf934e1}from'ckeditor5/src/utils';import _0x586a03 from'./revisiontracker';import _0x285545 from'./ui/revisionhistory/revisionhistoryui';import _0x344448 from'./revisionviewer';import _0x1446ff from'./ui/revisionviewer/revisionviewerui';import _0x10356e from'./ui/revisionssidebar/revisionssidebar';import _0x1db5d4 from'./editor/revisionviewereditor';import{getTranslation as _0x59b7d5}from'./utils/common-translations';export default class p extends _0x232b46{static get[_0x56d8('0x20')](){return _0x56d8('0x3');}static get['requires'](){return[_0x586a03,_0x285545];}constructor(_0x1384d0){if(super(_0x1384d0),!this[_0x56d8('0x62')][_0x56d8('0x40')][_0x56d8('0x39')]('revisionHistory'))throw new _0x4c078a(_0x56d8('0x2f'),this);this[_0x56d8('0x3f')]=null,this[_0x56d8('0x62')]['config'][_0x56d8('0x5e')](_0x56d8('0x3b'),_0x3a3793=>this[_0x56d8('0x44')](_0x3a3793)),this[_0x56d8('0x62')][_0x56d8('0x40')][_0x56d8('0x5e')](_0x56d8('0x16'),_0x440916=>this[_0x56d8('0x3c')](_0x440916)),this['editor'][_0x56d8('0x40')][_0x56d8('0x5e')](_0x56d8('0x71'),_0x54eb4a=>this[_0x56d8('0x72')](_0x54eb4a)),this[_0x56d8('0x64')](),this[_0x56d8('0x6f')]();}set[_0x56d8('0x8')](_0x5f81cb){this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x39')]('RevisionTracker')[_0x56d8('0x8')]=_0x5f81cb;}get[_0x56d8('0x8')](){return this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0xb'))[_0x56d8('0x8')];}[_0x56d8('0x54')](_0x3ff0a7){return this['editor'][_0x56d8('0x69')][_0x56d8('0x39')]('RevisionTracker')[_0x56d8('0x54')](_0x3ff0a7);}[_0x56d8('0x70')](_0x1ad669){return this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0x6e'))[_0x56d8('0x70')](_0x1ad669);}[_0x56d8('0x58')](_0x10300c={'toJSON':!0x1}){return this[_0x56d8('0x62')][_0x56d8('0x69')]['get'](_0x56d8('0x6e'))['getRevisions'](_0x10300c);}[_0x56d8('0x25')](){const _0x43cd7d=['context'],_0x1822c1=['RevisionTracker',_0x56d8('0x10'),'WebSocketGateway',_0x56d8('0xd'),_0x56d8('0x6b'),_0x56d8('0x6c')],_0x50bca0={},_0x53eb18=this['editor'],_0x8298f=_0x53eb18['plugins']['get'](_0x56d8('0xb')),_0x4eb24e=_0x53eb18[_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0xe'))['users'];for(const _0x23f53e of _0x53eb18[_0x56d8('0x40')][_0x56d8('0x34')]())_0x43cd7d[_0x56d8('0x53')](_0x23f53e)||(_0x50bca0[_0x23f53e]=_0x53eb18[_0x56d8('0x40')][_0x56d8('0x39')](_0x23f53e));delete _0x50bca0[_0x56d8('0x56')],delete _0x50bca0[_0x56d8('0x36')],_0x50bca0[_0x56d8('0x3e')]=[_0x56d8('0x7'),_0x56d8('0x1d'),_0x56d8('0x50')];const _0x4ae216=this['editor'][_0x56d8('0x47')][_0x56d8('0x23')]||[],_0x25c486=_0x50bca0[_0x56d8('0x28')]||[];delete _0x50bca0[_0x56d8('0x28')];const _0x139417=_0x4ae216[_0x56d8('0x49')](_0x50bca0[_0x56d8('0x69')])[_0x56d8('0x49')](_0x25c486)['map'](_0x1cdabb=>_0x56d8('0x18')==typeof _0x1cdabb?_0x4ae216[_0x56d8('0x45')](_0x3b8072=>_0x3b8072[_0x56d8('0x20')]==_0x1cdabb):_0x1cdabb);let _0x1dc36e=!0x1;_0x50bca0[_0x56d8('0x69')]=Array[_0x56d8('0x67')](new Set(_0x139417))['filter'](_0x2069c5=>_0x323e54(_0x2069c5,_0x53eb18['plugins'],[])),_0x1dc36e&&_0x50bca0['plugins'][_0x56d8('0x4b')](_0x53eb18[_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0x46'))['constructor']);function _0x323e54(_0x4a89fc,_0x344aeb,_0x6c3c4f){const _0x48c830=_0x56d8('0x4a')==typeof _0x4a89fc?_0x4a89fc[_0x56d8('0x20')]||_0x4a89fc[_0x56d8('0x14')]:_0x4a89fc;if(_0x56d8('0x46')===_0x48c830&&(_0x1dc36e=!0x0),_0x6c3c4f[_0x56d8('0x53')](_0x48c830))return!0x0;if(_0x6c3c4f['push'](_0x48c830),_0x1822c1[_0x56d8('0x53')](_0x48c830))return!0x1;const _0x41f392=(('function'==typeof _0x4a89fc?_0x4a89fc:_0x344aeb[_0x56d8('0x43')](_0x48c830)?_0x344aeb[_0x56d8('0x39')](_0x48c830):{})['requires']||[])[_0x56d8('0x15')](_0x22b91d=>_0x323e54(_0x22b91d,_0x344aeb,_0x6c3c4f));return _0x41f392||_0x1822c1['push'](_0x48c830),_0x41f392;}return _0x50bca0[_0x56d8('0x69')]['push'](_0x344448,_0x1446ff,class extends _0x232b46{static get[_0x56d8('0x26')](){return[_0x344448,_0x56d8('0xe')];}[_0x56d8('0x30')](){const _0x3daf8e=this['editor'][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0xe'));for(const _0x585137 of _0x4eb24e)_0x585137[_0x56d8('0x13')]||_0x3daf8e[_0x56d8('0x0')](_0x585137['id'])||_0x3daf8e['addUser'](_0x585137);const _0x265e95=_0x8298f[_0x56d8('0x33')]['getRevisions']();let _0x1d16b3=null;const _0x1af119=this['editor'][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0x27'));_0x1af119['adapter']=_0x8298f[_0x56d8('0x8')],_0x1af119[_0x56d8('0x2b')]('isEnabled')['to'](_0x8298f),this['editor']['commands'][_0x56d8('0x39')](_0x56d8('0x1d'))[_0x56d8('0x2b')](_0x56d8('0x31'))['to'](_0x53eb18,_0x56d8('0x21'),_0x4fdd3d=>!_0x4fdd3d);for(const _0x343a07 of _0x265e95){const _0x3a07e7=null===_0x343a07[_0x56d8('0x41')];if(_0x3a07e7&&_0x343a07[_0x56d8('0x9')]===_0x343a07[_0x56d8('0x52')])continue;const _0x21e9f7=_0x343a07[_0x56d8('0xa')]();_0x1af119[_0x56d8('0x54')](_0x21e9f7,(_0x527578,_0x310e54,_0xec7301)=>{if(_0x3a07e7){if(_0x1d16b3)_0x1d16b3[_0x56d8('0xc')](_0x527578,_0x310e54);else{if(!_0x310e54){const _0x327c25=_0xec7301[_0x56d8('0xa')]();_0x327c25['id']=_0xf934e1(),_0x8298f[_0x56d8('0x1c')](_0x327c25,_0xec7301['toVersion'])['then'](_0x5cfce5=>{_0x1d16b3=_0x5cfce5;});}}}else _0x343a07[_0x56d8('0xc')](_0x527578,_0x310e54);});}}},_0x10356e),_0x50bca0;}[_0x56d8('0x64')](){const _0x593fa9=this[_0x56d8('0x62')][_0x56d8('0x40')][_0x56d8('0x39')]('revisionHistory')['showRevisionViewerCallback'];this[_0x56d8('0x62')]['config'][_0x56d8('0x32')](_0x56d8('0x3b'),async()=>{this['editor'][_0x56d8('0x61')](_0x56d8('0x66'));const _0x1ab25f=this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0xb'));if(this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x43')](_0x56d8('0x6b'))){const _0x1d1882=this['editor'][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0x6b'));await _0x1d1882[_0x56d8('0x11')]();}else await _0x1ab25f[_0x56d8('0x55')]();this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x43')](_0x56d8('0x2d'))&&this[_0x56d8('0x62')]['plugins'][_0x56d8('0x39')](_0x56d8('0x2d'))['_recalculatePageBreaks']();const _0x191723=this[_0x56d8('0x25')]();return _0x593fa9(_0x191723)['then'](_0x45e10a=>{return(this[_0x56d8('0x3f')]=_0x45e10a,this[_0x56d8('0x62')][_0x56d8('0x69')]['has']('Annotations'))&&this[_0x56d8('0x62')]['plugins']['get'](_0x56d8('0x4c'))[_0x56d8('0x22')](),_0x45e10a;})[_0x56d8('0x4')](_0x46249b=>(console[_0x56d8('0x57')](_0x46249b),this['editor'][_0x56d8('0x5d')](_0x56d8('0x66')),null));});}[_0x56d8('0x6f')](){const _0x62270f=this[_0x56d8('0x62')][_0x56d8('0x40')][_0x56d8('0x39')]('revisionHistory')['closeRevisionViewerCallback'];this['editor'][_0x56d8('0x40')][_0x56d8('0x32')](_0x56d8('0x16'),()=>(this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x43')](_0x56d8('0x2d'))&&this[_0x56d8('0x62')][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0x2d'))[_0x56d8('0x37')](),this[_0x56d8('0x3f')][_0x56d8('0x69')]['get']('RevisionViewer')[_0x56d8('0x1a')](),_0x62270f(this['_viewerEditor'])[_0x56d8('0x4e')](()=>{if(this[_0x56d8('0x62')][_0x56d8('0x5d')](_0x56d8('0x66')),this[_0x56d8('0x3f')]=null,this[_0x56d8('0x62')]['plugins'][_0x56d8('0x43')](_0x56d8('0x4c'))){const _0x103d23=this['editor']['plugins'][_0x56d8('0x39')]('Annotations');_0x103d23[_0x56d8('0x22')](),_0x103d23[_0x56d8('0x5c')]();}})));}[_0x56d8('0x44')](_0x283902){const _0x1e1a84=this[_0x56d8('0x62')]['config'][_0x56d8('0x39')](_0x56d8('0x17')),_0x559470=this[_0x56d8('0x62')][_0x56d8('0x40')][_0x56d8('0x39')](_0x56d8('0x3a')),_0xd45943=this['editor']['config'][_0x56d8('0x39')](_0x56d8('0x65'));return _0x1db5d4[_0x56d8('0x3d')](_0xd45943,_0x283902)['then'](_0x44c972=>(_0x559470[_0x56d8('0x4d')][_0x56d8('0x29')]=_0x56d8('0x63'),_0x1e1a84[_0x56d8('0x4d')][_0x56d8('0x29')]=_0x56d8('0x2'),_0x44c972));}['_closeRevisionViewer'](_0x395094){const _0x4ce82e=this['editor'][_0x56d8('0x40')][_0x56d8('0x39')]('revisionHistory.editorContainer');return this[_0x56d8('0x62')][_0x56d8('0x40')]['get'](_0x56d8('0x3a'))[_0x56d8('0x4d')][_0x56d8('0x29')]=_0x56d8('0x2'),_0x4ce82e[_0x56d8('0x4d')][_0x56d8('0x29')]='',_0x395094[_0x56d8('0x1e')]();}async[_0x56d8('0x72')](_0x1af0cc){const _0x56334a=this[_0x56d8('0x62')],_0x4864cf=this[_0x56d8('0x3f')][_0x56d8('0x69')][_0x56d8('0x39')](_0x56d8('0x27')),_0x39f9cb=_0x56334a['plugins'][_0x56d8('0x39')](_0x56d8('0xb')),_0x1ad82e=_0x4864cf[_0x56d8('0x33')][_0x56d8('0x70')](_0x1af0cc);let _0x58faf9,_0x23161c,_0x2c4ea1;try{_0x58faf9=await _0x4864cf[_0x56d8('0x6')](_0x1ad82e),_0x23161c=await _0x4864cf['getRevisionRootsAttributes'](_0x1ad82e);}catch(_0x3b6bd5){return void console[_0x56d8('0x57')](_0x3b6bd5);}_0x56334a[_0x56d8('0x5')][_0x56d8('0x48')](_0x555a61=>{for(const _0x3ef940 of Array[_0x56d8('0x67')](_0x56334a[_0x56d8('0x5')][_0x56d8('0x38')][_0x56d8('0x5b')](_0x56d8('0x12'))))_0x555a61[_0x56d8('0x24')](_0x3ef940);}),_0x4864cf[_0x56d8('0x42')]=!0x1,_0x56334a[_0x56d8('0x5')][_0x56d8('0x2e')](_0x18d86d=>{_0x18d86d['setSelection'](null),_0x18d86d[_0x56d8('0x1f')](_0x56334a[_0x56d8('0x5')]['document'][_0x56d8('0x5a')][_0x56d8('0x51')]());for(const _0x5b81f3 of _0x56334a[_0x56d8('0x5')][_0x56d8('0x68')][_0x56d8('0xf')]())_0x18d86d[_0x56d8('0x2c')](_0x5b81f3);for(const _0x61af47 of Object[_0x56d8('0x35')](_0x58faf9)){const _0x59e298=_0x18d86d['addRoot'](_0x61af47);for(const _0x5ef378 of Object[_0x56d8('0x35')](_0x23161c[_0x61af47]))_0x18d86d['setAttribute'](_0x5ef378,_0x23161c[_0x61af47][_0x5ef378],_0x59e298);_0x18d86d['insert'](_0x56334a[_0x56d8('0x4f')][_0x56d8('0x59')](_0x58faf9[_0x61af47],_0x59e298),_0x59e298,0x0);}});const _0x1f0f6f=_0x59b7d5(_0x56334a[_0x56d8('0x6a')],_0x56d8('0x1'));if(_0x1ad82e[_0x56d8('0x14')])_0x2c4ea1=-0x1==_0x1ad82e['name'][_0x56d8('0x2a')](_0x1f0f6f)?_0x1f0f6f+':\x20'+_0x1ad82e['name']:_0x1ad82e[_0x56d8('0x14')];else _0x2c4ea1=_0x1f0f6f+':\x20'+(_0x1ad82e[_0x56d8('0x1b')]['toLocaleDateString'](_0x56334a[_0x56d8('0x6a')][_0x56d8('0x5f')],{'month':_0x56d8('0x6d'),'day':'numeric'})+',\x20'+_0x1ad82e[_0x56d8('0x1b')][_0x56d8('0x19')](_0x56334a['locale'][_0x56d8('0x5f')],{'hour':'numeric','minute':_0x56d8('0x60')}));return await _0x39f9cb[_0x56d8('0x1c')]({'name':_0x2c4ea1}),_0x4864cf[_0x56d8('0x42')]=!0x0,_0x56334a[_0x56d8('0x40')][_0x56d8('0x39')]('revisionHistory')[_0x56d8('0x73')]();}}