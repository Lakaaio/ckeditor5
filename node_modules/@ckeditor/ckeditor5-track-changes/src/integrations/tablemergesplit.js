/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x3211=['insertion','getSuggestions','TableUtils','getFirstPosition','length','mergeTableCells','forceDefaultExecution','has','isInContent','push','getAncestors','get','low','model','$graveyard','return','trackChanges','registerCustomCallback','find','stop','enableCommand','author','editor','TableEditing','document','containsRange','set:isEnabled','from','getRanges','format','_areSelectedCellsMergable','_isForcedDefaultExecutionBlock','createTableWalker','cell','change','_suggestionFactory','getSelectionAffectedTableCells','commandName','*Merge\x20cells*','_tablePostFixingSubtypes','size','splitTableCellVertically','_descriptionFactory','rootName','add','accept','registerDescriptionCallback','requires','mergeTableCellLeft','*Split\x20cell:*\x20vertically','mergeTableCellRight','table','tableCell','refresh','plugins','setSelection','*Split\x20cell:*\x20horizontally','element','markMultiRangeBlockFormat','type','getCellLocation','mergeTableCellDown','selection','isEnabled','TrackChangesEditing','value','detach','fromRange','filter','createRangeOn','mergeTableCellUp','splitTableCellHorizontally','commands','markBlockFormat','map','_areMergableCells','execute','formatBlock','locale'];(function(_0x480e3c,_0x3211aa){const _0x293ab0=function(_0x1a85f5){while(--_0x1a85f5){_0x480e3c['push'](_0x480e3c['shift']());}};_0x293ab0(++_0x3211aa);}(_0x3211,0x192));const _0x293a=function(_0x480e3c,_0x3211aa){_0x480e3c=_0x480e3c-0x0;let _0x293ab0=_0x3211[_0x480e3c];return _0x293ab0;};import{Plugin as _0x1cccc9}from'ckeditor5/src/core';import _0x3b97b1 from'./table';import{LiveRange as _0x9e4797}from'ckeditor5/src/engine';import{getTranslation as _0x4949c7}from'../utils/common-translations';export default class dt extends _0x1cccc9{static get[_0x293a('0x28')](){return[_0x3b97b1];}['afterInit'](){const _0x4f17ab=this['editor'],_0x56f0b4=_0x4f17ab['model'][_0x293a('0x11')][_0x293a('0x37')],_0x23c268=_0x4f17ab[_0x293a('0x47')];if(!_0x4f17ab[_0x293a('0x2f')][_0x293a('0x0')](_0x293a('0x10')))return;const _0x357492=_0x4f17ab['plugins']['get'](_0x293a('0x39')),_0x1dfbc1=_0x4f17ab[_0x293a('0x2f')][_0x293a('0x4')]('TableUtils'),_0x1428f0=_0x4f17ab[_0x293a('0x2f')][_0x293a('0x4')](_0x3b97b1);_0x1428f0[_0x293a('0x20')][_0x293a('0x2')](_0x293a('0x4d')),_0x357492['enableCommand'](_0x293a('0x4d'),()=>{const _0x337aec=_0x1dfbc1[_0x293a('0x1d')](_0x4f17ab[_0x293a('0x6')]['document']['selection']);_0x4f17ab['model'][_0x293a('0x1b')](()=>{_0x357492['markMultiRangeBlockFormat'](_0x337aec,{'commandName':_0x293a('0x4d'),'commandParams':[]},[],_0x293a('0x4d'));});}),_0x4f17ab[_0x293a('0x41')]['get'](_0x293a('0x4d'))['on'](_0x293a('0x45'),(_0x49a3a2,_0x4fa82a)=>{_0x4f17ab[_0x293a('0x41')][_0x293a('0x4')](_0x293a('0x9'))[_0x293a('0x3a')]&&(_0x4fa82a[_0x293a('0x4c')]>0x0&&_0x4fa82a[_0x4fa82a[_0x293a('0x4c')]-0x1]&&_0x4fa82a[_0x4fa82a[_0x293a('0x4c')]-0x1][_0x293a('0x4e')]||_0x357492[_0x293a('0x18')]||this['_areSelectedCellsMergable']()||_0x49a3a2[_0x293a('0xc')]());},{'priority':'highest'});for(const _0x1309ba of['mergeTableCellUp',_0x293a('0x2b'),_0x293a('0x36'),_0x293a('0x29')]){const _0x2c06ac=_0x4f17ab[_0x293a('0x41')][_0x293a('0x4')](_0x1309ba);_0x357492[_0x293a('0xd')](_0x1309ba,()=>{const _0x53a6a9=_0x4f17ab[_0x293a('0x6')][_0x293a('0x11')][_0x293a('0x37')][_0x293a('0x4b')]()[_0x293a('0x3')]()[_0x293a('0xb')](_0x6e7fe=>_0x6e7fe['is'](_0x293a('0x32'),_0x293a('0x2d'))),_0x1643b5=_0x2c06ac[_0x293a('0x3a')];_0x4f17ab[_0x293a('0x6')][_0x293a('0x1b')](()=>{_0x357492[_0x293a('0x33')]([_0x53a6a9,_0x1643b5],{'commandName':_0x293a('0x4d'),'commandParams':[]},[],'mergeTableCells');});});}for(const _0x299b39 of[_0x293a('0x22'),_0x293a('0x40')]){const _0x494b56=_0x4f17ab[_0x293a('0x41')][_0x293a('0x4')](_0x299b39);_0x357492['enableCommand'](_0x299b39,()=>{const _0x1d9a67=_0x1dfbc1[_0x293a('0x1d')](_0x4f17ab['model'][_0x293a('0x11')][_0x293a('0x37')])[0x0],_0x172241=_0x1d9a67['findAncestor'](_0x293a('0x2c')),{column:_0x54d174,row:_0x1acd30}=_0x1dfbc1[_0x293a('0x35')](_0x1d9a67);let _0x36d8a4=[];if('horizontally'==_0x494b56['direction']){const _0x1c8e23=_0x1dfbc1[_0x293a('0x19')](_0x172241,{'startRow':_0x1acd30,'endRow':_0x1acd30,'includeAllSlots':!0x0});_0x36d8a4=Array[_0x293a('0x14')](_0x1c8e23)[_0x293a('0x43')](_0x33a640=>_0x33a640[_0x293a('0x1a')]);}else{const _0x21aab9=_0x1dfbc1['createTableWalker'](_0x172241,{'column':_0x54d174,'includeAllSlots':!0x0});_0x36d8a4=Array[_0x293a('0x14')](_0x21aab9)[_0x293a('0x43')](_0x5a2e15=>_0x5a2e15[_0x293a('0x1a')]);}_0x4f17ab[_0x293a('0x6')][_0x293a('0x1b')](_0x47209d=>{_0x357492[_0x293a('0x42')](_0x47209d[_0x293a('0x3e')](_0x1d9a67),{'commandName':_0x299b39,'commandParams':[]},_0x36d8a4,_0x299b39);});});}_0x357492[_0x293a('0x23')][_0x293a('0x27')](_0x132740=>{const {data:_0x11ba47}=_0x132740;if(_0x11ba47)return'mergeTableCells'==_0x11ba47['commandName']?{'type':'format','content':_0x4949c7(_0x23c268,_0x293a('0x1f'))}:void 0x0;}),_0x357492[_0x293a('0x23')][_0x293a('0x27')](_0x58bd88=>{const {data:_0x289784}=_0x58bd88;if(_0x289784)return'splitTableCellVertically'==_0x289784[_0x293a('0x1e')]?{'type':'format','content':_0x4949c7(_0x23c268,_0x293a('0x2a'))}:_0x293a('0x40')==_0x289784['commandName']?{'type':_0x293a('0x16'),'content':_0x4949c7(_0x23c268,_0x293a('0x31'))}:void 0x0;});const _0x1d8ea1=_0x1428f0['_acceptFormatSuggestionCallbackFactory']();for(const _0x206bf8 of[_0x293a('0x3f'),_0x293a('0x2b'),_0x293a('0x36'),_0x293a('0x29')])_0x357492['_suggestionFactory'][_0x293a('0xa')](_0x293a('0x46'),_0x206bf8,_0x293a('0x26'),_0x1d8ea1);for(const _0x1a583b of[_0x293a('0x22'),'splitTableCellHorizontally'])_0x357492[_0x293a('0x1c')][_0x293a('0xa')](_0x293a('0x46'),_0x1a583b,'accept',_0x1d8ea1);_0x357492[_0x293a('0x1c')]['registerCustomCallback'](_0x293a('0x46'),_0x293a('0x4d'),'accept',_0x46676c=>{_0x4f17ab[_0x293a('0x6')]['change'](_0x352721=>{const _0x56760a=Array[_0x293a('0x14')](_0x56f0b4[_0x293a('0x15')]())[_0x293a('0x43')](_0x4f82f7=>_0x9e4797[_0x293a('0x3c')](_0x4f82f7));_0x352721[_0x293a('0x30')](_0x46676c),_0x4f17ab['commands']['get']('mergeTableCells')[_0x293a('0x2e')](),_0x4f17ab['execute']('mergeTableCells',{'forceDefaultExecution':!0x0});const _0x584417=_0x56760a[_0x293a('0x3d')](_0x247699=>_0x293a('0x7')!=_0x247699['root'][_0x293a('0x24')]);_0x584417[_0x293a('0x4c')]>0x0&&_0x352721[_0x293a('0x30')](_0x584417);for(const _0x56e0c5 of _0x56760a)_0x56e0c5[_0x293a('0x3b')]();});});for(const _0x3f1049 of[_0x293a('0x3f'),_0x293a('0x36'),_0x293a('0x29'),'mergeTableCellRight']){const _0xee5f34=_0x4f17ab[_0x293a('0x41')][_0x293a('0x4')](_0x3f1049);_0xee5f34['on'](_0x293a('0x13'),(_0x1c65e6,_0x66c182,_0x5bcbb9)=>{if(_0x5bcbb9){const _0x2119a1=_0x4f17ab['model'][_0x293a('0x11')]['selection'][_0x293a('0x4b')]()['getAncestors']()[_0x293a('0xb')](_0x52ab8e=>_0x52ab8e['is'](_0x293a('0x32'),'tableCell'));this['_areMergableCells'](_0xee5f34['value'],_0x2119a1)||(_0x1c65e6[_0x293a('0x8')]=!0x1,_0x1c65e6['stop']());}},{'priority':_0x293a('0x5')});}}[_0x293a('0x17')](){const _0x1f277a=this['editor'][_0x293a('0x41')][_0x293a('0x4')](_0x293a('0x4d')),_0xb82bbf=this['editor'][_0x293a('0x2f')][_0x293a('0x4')](_0x293a('0x4a'));if(!_0x1f277a[_0x293a('0x38')])return!0x1;const _0x41a2c7=_0xb82bbf['getSelectionAffectedTableCells'](this[_0x293a('0xf')]['model'][_0x293a('0x11')]['selection']);for(const _0x4bb772 of _0x41a2c7)for(const _0x15e69b of _0x41a2c7)if(_0x4bb772!=_0x15e69b&&!this[_0x293a('0x44')](_0x4bb772,_0x15e69b))return!0x1;return!0x0;}[_0x293a('0x44')](_0x2fbcd4,_0x1f71d8){const _0x4a9ba4=this[_0x293a('0xf')][_0x293a('0x2f')][_0x293a('0x4')]('TrackChangesEditing'),_0x1f8c02=this[_0x293a('0xf')][_0x293a('0x6')][_0x293a('0x3e')](_0x2fbcd4),_0x260ece=this[_0x293a('0xf')][_0x293a('0x6')][_0x293a('0x3e')](_0x1f71d8),_0x146dd9=new Set(),_0x458db7=new Set();for(const _0x54e107 of _0x4a9ba4[_0x293a('0x49')]())if((_0x293a('0x48')==_0x54e107[_0x293a('0x34')]||'deletion'==_0x54e107[_0x293a('0x34')]||'mergeTableCells'==_0x54e107['subType'])&&_0x54e107[_0x293a('0x1')])for(const _0x4348e0 of _0x54e107['getRanges']())_0x4348e0['containsRange'](_0x1f8c02,!0x0)&&_0x146dd9['add'](_0x54e107[_0x293a('0x34')]+':'+_0x54e107[_0x293a('0xe')]['id']),_0x4348e0[_0x293a('0x12')](_0x260ece,!0x0)&&_0x458db7[_0x293a('0x25')](_0x54e107[_0x293a('0x34')]+':'+_0x54e107['author']['id']);if(_0x146dd9[_0x293a('0x21')]!=_0x458db7[_0x293a('0x21')])return!0x1;for(const _0x403d01 of _0x146dd9)if(!_0x458db7[_0x293a('0x0')](_0x403d01))return!0x1;return!0x0;}}