/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2f15=['annotation','_editorAnnotationsData','selection','focusTracker','getRanges','innerView','map','registerAnnotation','listenTo','model','init','_dataCollectors','addSourceCollector','hasDomSelection','containsRange','document','sort','set','editing','refreshSelectedViews','has','collection','add','fire','push','plugins','isCollapsed','directChange','pluginName','range','editor','isEqual','_editorAnnotations','view','from','remove','change:range','getByInnerView','requires','element','uiUpdate','EditorAnnotations','change:isFocused','refresh'];(function(_0xc6895c,_0x2f154d){const _0xb91706=function(_0x358af1){while(--_0x358af1){_0xc6895c['push'](_0xc6895c['shift']());}};_0xb91706(++_0x2f154d);}(_0x2f15,0x98));const _0xb917=function(_0xc6895c,_0x2f154d){_0xc6895c=_0xc6895c-0x0;let _0xb91706=_0x2f15[_0xc6895c];return _0xb91706;};import{Plugin as _0x3ff307}from'ckeditor5/src/core';import{CKEditorError as _0x62d1ad}from'ckeditor5/src/utils';import{debounce as _0x4148c5}from'lodash-es';import _0x320b96 from'./annotations';export default class k extends _0x3ff307{static get[_0xb917('0x12')](){return[_0x320b96];}static get[_0xb917('0x8')](){return _0xb917('0x15');}constructor(_0x197b67){super(_0x197b67),this[_0xb917('0x23')]=new Set(),this[_0xb917('0xc')]=new Set();}[_0xb917('0x22')](){const _0x3c6ca5=this['editor'],_0x5501c9=_0x3c6ca5[_0xb917('0x21')][_0xb917('0x27')][_0xb917('0x1a')],_0x112f9a=_0x4148c5(()=>this['refreshSelectedViews'](),0xa);_0x5501c9['on'](_0xb917('0x10'),(_0x466e34,_0x1dea5c)=>{_0x1dea5c[_0xb917('0x7')]&&(_0x112f9a['cancel'](),this[_0xb917('0x2b')]());}),this[_0xb917('0x20')](_0x3c6ca5[_0xb917('0x2a')][_0xb917('0xd')][_0xb917('0x27')],'change:isFocused',(_0x4355bc,_0x1d70c0,_0x454e0b)=>{_0x454e0b&&_0x112f9a();}),this['listenTo'](_0x3c6ca5['ui']['focusTracker'],_0xb917('0x16'),(_0x41d47f,_0x18c88f,_0x5eac5f)=>{_0x5eac5f||_0x3c6ca5['isReadOnly']||this[_0xb917('0x3')]('blur',{'isAnnotationTracked':_0x14ee8e=>this[_0xb917('0x19')][_0xb917('0x0')](_0x14ee8e[_0xb917('0x1d')])});}),this[_0xb917('0x20')](this[_0xb917('0xa')]['ui'],'update',()=>this[_0xb917('0x3')](_0xb917('0x14')));}[_0xb917('0x1f')](_0x57c436){if(this[_0xb917('0xc')][_0xb917('0x0')](_0x57c436['view']))return;this[_0xb917('0xc')][_0xb917('0x2')](_0x57c436[_0xb917('0xd')]),this[_0xb917('0xa')]['ui'][_0xb917('0x1b')][_0xb917('0x2')](_0x57c436['view'][_0xb917('0x13')]);const _0x364660=this[_0xb917('0xa')][_0xb917('0x5')]['get'](_0x320b96);this[_0xb917('0x20')](_0x364660[_0xb917('0x1')],'remove',(_0x3e83a1,_0x176b71)=>{this[_0xb917('0xa')]['ui'][_0xb917('0x1b')][_0xb917('0xf')](_0x176b71['view'][_0xb917('0x13')]),this[_0xb917('0xc')]['delete'](_0x176b71[_0xb917('0xd')]);});}[_0xb917('0x25')](){return this['editor'][_0xb917('0x2a')][_0xb917('0xd')]['hasDomSelection'];}[_0xb917('0x24')](_0x3ae85a){if('function'!=typeof _0x3ae85a)throw new _0x62d1ad('editorannotations-invalid-source-callback');this[_0xb917('0x23')]['add'](_0x3ae85a);}[_0xb917('0x2b')](){this[_0xb917('0x3')](_0xb917('0x17'));}['getOrderedSelectedAnnotations']({activeAnnotation:_0x465110,annotations:_0x529333}){const _0x274c04=[],_0x20e5b8=this['editor'][_0xb917('0x21')]['document'][_0xb917('0x1a')],_0x1978de=Array[_0xb917('0xe')](_0x20e5b8[_0xb917('0x1c')]());for(const [_0x205b8,_0x234b22]of this[_0xb917('0x19')]){const _0x550c67=_0xd36823(_0x234b22),_0x3ae4be=_0x529333[_0xb917('0x11')](_0x205b8);_0x550c67&&_0x3ae4be&&_0x274c04[_0xb917('0x4')]({'annotation':_0x3ae4be,'range':_0x550c67});}function _0xd36823(_0x378729){for(const _0x4e6c57 of _0x378729)for(const _0x193588 of _0x1978de)if(_0x4e6c57['containsRange'](_0x193588,!_0x20e5b8[_0xb917('0x6')]))return _0x4e6c57;return null;}return _0x274c04[_0xb917('0x28')]((_0x42a5bd,_0x1e276f)=>{const _0x351440=_0x42a5bd[_0xb917('0x9')],_0x531681=_0x1e276f['range'];if(!_0x351440[_0xb917('0xb')](_0x531681)){if(_0x351440[_0xb917('0x26')](_0x531681,!0x0))return 0x1;if(_0x531681[_0xb917('0x26')](_0x351440,!0x0))return-0x1;}return _0x42a5bd[_0xb917('0x18')]==_0x465110?-0x1:_0x1e276f['annotation']==_0x465110?0x1:0x0;})[_0xb917('0x1e')](_0x5aa7eb=>_0x5aa7eb[_0xb917('0x18')]);}get[_0xb917('0x19')](){const _0x45d0c5=new Map();for(const _0x5ec059 of Array['from'](this['_dataCollectors']))for(const [_0x31cfa7,_0x56691e]of _0x5ec059())_0x45d0c5[_0xb917('0x29')](_0x31cfa7,_0x56691e);return _0x45d0c5;}}