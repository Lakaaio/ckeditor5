/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x16a3=['get','requires','annotationsuis-annotation-mismatch','size','_activateAnnotation','deactivateAll','_uisData','delete','_deactivateAllAnnotations','setActiveAnnotation','refilterAnnotations','isActive','stopListening','attach','_removeActiveAnnotation','activate','_visibleAnnotations','init','switchTo','annotationsuis-register-already-registered','plugins','remove','_uis','destroy','_addActiveAnnotation','collection','type','register','from','filter','_setSelectedAnnotations','has','context','annotationsuis-missing-ui','function','activeUIs','annotationsuis-register-invalid-interface','detach','pluginName','push','change:activeAnnotation','listenTo','_assertAnnotationDoesNotBelongToMultipleUIs','add','AnnotationsUIs','length','deactivate','set'];(function(_0x4db193,_0x16a30b){const _0x25539e=function(_0x15633b){while(--_0x15633b){_0x4db193['push'](_0x4db193['shift']());}};_0x25539e(++_0x16a30b);}(_0x16a3,0x1aa));const _0x2553=function(_0x4db193,_0x16a30b){_0x4db193=_0x4db193-0x0;let _0x25539e=_0x16a3[_0x4db193];return _0x25539e;};import{ContextPlugin as _0x304656}from'ckeditor5/src/core';import{CKEditorError as _0x50df83}from'ckeditor5/src/utils';import _0x349ce1,{bindAnnotationCollections as _0x257d09}from'./annotationcollection';import _0x5b210a from'./annotations';export default class M extends _0x304656{static get[_0x2553('0x7')](){return[_0x5b210a];}static get[_0x2553('0x2c')](){return _0x2553('0x2');}constructor(_0x59f9bf){super(_0x59f9bf),this[_0x2553('0x29')]=new Set(),this[_0x2553('0x1c')]=new Map(),this['_uisData']=new Map();}[_0x2553('0x17')](){const _0x3b2fba=this[_0x2553('0x26')][_0x2553('0x1a')][_0x2553('0x6')](_0x5b210a);this[_0x2553('0x2f')](_0x3b2fba,_0x2553('0xa'),(_0x39d570,_0xbec2dc)=>{for(const _0x272bcc of this['activeUIs']){const _0x3eb3a2=this[_0x2553('0x1c')][_0x2553('0x6')](_0x272bcc);(0x0,this[_0x2553('0xc')][_0x2553('0x6')](_0x272bcc)[_0x2553('0x23')])(_0xbec2dc)&&_0x3eb3a2[_0x2553('0xf')](_0xbec2dc);}}),this[_0x2553('0x2f')](_0x3b2fba,_0x2553('0xe'),()=>{for(const _0x37e9b2 of this[_0x2553('0x29')]){this[_0x2553('0x1c')]['get'](_0x37e9b2)[_0x2553('0xf')](null);}}),this[_0x2553('0x2f')](_0x3b2fba[_0x2553('0x16')],_0x2553('0x1'),(_0x3e9e1f,_0x4e9afe)=>{this[_0x2553('0x0')](_0x4e9afe);});}['hasActive'](){return this['activeUIs'][_0x2553('0x9')]>0x0;}[_0x2553('0x11')](_0x4fb3b1){return this[_0x2553('0x29')]['has'](_0x4fb3b1);}['activate'](_0x37e1ad,_0x3fb4af=()=>!0x0){const _0x13e817=this['context'][_0x2553('0x1a')][_0x2553('0x6')](_0x5b210a);if(!this[_0x2553('0x1c')]['has'](_0x37e1ad))throw new _0x50df83(_0x2553('0x27'),this,{'uiName':_0x37e1ad});this[_0x2553('0x11')](_0x37e1ad)&&this['deactivate'](_0x37e1ad),this[_0x2553('0x29')][_0x2553('0x1')](_0x37e1ad);const _0x5c5f40=new _0x349ce1(),_0x27ff58=_0x13e817[_0x2553('0x16')];_0x257d09({'source':_0x27ff58,'target':_0x5c5f40,'filter':_0x3fb4af}),this[_0x2553('0xc')][_0x2553('0x5')](_0x37e1ad,{'collection':_0x5c5f40,'filter':_0x3fb4af});const _0x4c9e0e=this['_uis'][_0x2553('0x6')](_0x37e1ad);_0x4c9e0e[_0x2553('0x13')](_0x5c5f40),this[_0x2553('0x2f')](_0x4c9e0e,_0x2553('0x2e'),(_0x51ba4e,_0x1e101e,_0x2530bc,_0x51d278)=>{_0x51d278&&_0x13e817[_0x2553('0x14')](_0x51d278),_0x2530bc&&_0x13e817[_0x2553('0x1e')](_0x2530bc);});}[_0x2553('0x4')](_0x195dd5){if(this[_0x2553('0x29')][_0x2553('0xd')](_0x195dd5),!this[_0x2553('0x1c')][_0x2553('0x25')](_0x195dd5))throw new _0x50df83(_0x2553('0x27'),this,{'uiName':_0x195dd5});const _0x5d8d13=this['_uis'][_0x2553('0x6')](_0x195dd5);_0x5d8d13[_0x2553('0x2b')](),this[_0x2553('0x12')](_0x5d8d13),this[_0x2553('0xc')][_0x2553('0x6')](_0x195dd5)[_0x2553('0x1f')][_0x2553('0x1d')](),this[_0x2553('0xc')]['delete'](_0x195dd5);}[_0x2553('0x18')](_0x420666){if(!this['_uis'][_0x2553('0x25')](_0x420666))throw new _0x50df83(_0x2553('0x27'),this,{'uiName':_0x420666});const _0x156039=this[_0x2553('0x26')][_0x2553('0x1a')][_0x2553('0x6')](_0x5b210a),_0x38e4ab=Array[_0x2553('0x22')](_0x156039['activeAnnotations'])[0x0]||null;this['deactivateAll'](),this[_0x2553('0x15')](_0x420666);const _0x3b26a8=this[_0x2553('0x1c')]['get'](_0x420666);_0x3b26a8[_0x2553('0xf')](_0x38e4ab),_0x3b26a8[_0x2553('0x24')]&&_0x38e4ab&&_0x3b26a8[_0x2553('0x24')]([_0x38e4ab]);}[_0x2553('0xb')](){for(const _0xf0f226 of this[_0x2553('0x29')])this[_0x2553('0x4')](_0xf0f226);}[_0x2553('0x21')](_0x1dcfcc,_0x2987b6){if(this[_0x2553('0x1c')]['has'](_0x1dcfcc))throw new _0x50df83(_0x2553('0x19'));if('function'!=typeof _0x2987b6['attach']||_0x2553('0x28')!=typeof _0x2987b6[_0x2553('0x2b')]||_0x2553('0x28')!=typeof _0x2987b6[_0x2553('0xf')])throw new _0x50df83(_0x2553('0x2a'),null);this['_uis'][_0x2553('0x5')](_0x1dcfcc,_0x2987b6);}[_0x2553('0x10')](){const _0x2c80f3=this['context'][_0x2553('0x1a')][_0x2553('0x6')](_0x5b210a)[_0x2553('0x1f')],_0x19fff4=new Map(),_0x33b4fd=Array[_0x2553('0x22')](this[_0x2553('0x29')]);for(const _0x1b1b47 of this['activeUIs']){const _0x30f5c7=this[_0x2553('0xc')][_0x2553('0x6')](_0x1b1b47)['collection'];for(const _0x2b738a of _0x30f5c7)_0x19fff4[_0x2553('0x5')](_0x2b738a,_0x1b1b47);}for(const _0x3da3ff of _0x2c80f3){const _0x437fad=_0x19fff4['get'](_0x3da3ff);this['_assertAnnotationDoesNotBelongToMultipleUIs'](_0x3da3ff);const _0x4000b4=_0x33b4fd['find'](_0x7a4388=>this[_0x2553('0xc')][_0x2553('0x6')](_0x7a4388)[_0x2553('0x23')](_0x3da3ff));_0x437fad!==_0x4000b4&&(_0x437fad&&this[_0x2553('0xc')][_0x2553('0x6')](_0x437fad)[_0x2553('0x1f')][_0x2553('0x1b')](_0x3da3ff),_0x4000b4&&this[_0x2553('0xc')]['get'](_0x4000b4)[_0x2553('0x1f')]['add'](_0x3da3ff));}}[_0x2553('0x1d')](){this['deactivateAll'](),super[_0x2553('0x1d')]();}[_0x2553('0x0')](_0x5e8015){const _0x5b1720=[];for(const _0x8f55c4 of this[_0x2553('0x29')]){(0x0,this[_0x2553('0xc')][_0x2553('0x6')](_0x8f55c4)[_0x2553('0x23')])(_0x5e8015)&&_0x5b1720[_0x2553('0x2d')](_0x8f55c4);}if(_0x5b1720[_0x2553('0x3')]>0x1)throw new _0x50df83(_0x2553('0x8'),null,{'matchedUIs':_0x5b1720,'annotationType':_0x5e8015[_0x2553('0x20')]});}}