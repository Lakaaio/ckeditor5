/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2898=['set:container','view','target','_updateBalloonPosition','getOrderedSelectedAnnotations','init','NarrowSidebar','_detachFromContainer','bind','_refreshPositioning','off','stopListening','set','isDirty','contains','_setSelectedAnnotations','annotations','from','context','refresh','ready','Esc','activeAnnotation','annotationType','_annotationToNarrowView','focus','southArrowNorthEast','_attachListeners','isAttached','hasDomSelection','editors','_integrateWithEditorAnnotations','remove','add','execute','high','low','stop','plugins','_detachListeners','detach','isVisible','attachToDom','preventClosingBalloon','attach','number','pluginName','_refreshPositioningDebounced','get','ck-sidebar--narrow','change:height','locale','change:container','balloonPanelView','EditorAnnotations','narrowsidebar-detach-not-attached','addAnnotation','_destroyEditorAnnotationsIntegration','removeEventListener','northArrowSouthEast','delete','_hideBalloon','clear','cancel','esc','values','resize','refreshPositioning','stopPropagation','has','southArrowNorth','_selectedAnnotations','content','_manuallyClosedAnnotationViews','listenTo','_showBalloon','getSidebarItemView','setActiveAnnotation','unpin','keyCode','length','bodyCollection','destroy','first','element','register','_domEmitter','_editorAnnotations','blur','mousedown','includes'];(function(_0x1bf3f7,_0x2898d2){const _0x234e29=function(_0x1c5cf3){while(--_0x1c5cf3){_0x1bf3f7['push'](_0x1bf3f7['shift']());}};_0x234e29(++_0x2898d2);}(_0x2898,0xd9));const _0x234e=function(_0x1bf3f7,_0x2898d2){_0x1bf3f7=_0x1bf3f7-0x0;let _0x234e29=_0x2898[_0x1bf3f7];return _0x234e29;};import{ContextPlugin as _0x8e223d,Context as _0x1e70b5}from'ckeditor5/src/core';import _0x45c244 from'./annotationsuis';import _0x20dc59 from'./sidebar';import _0x1981f7 from'./view/annotationcounterbuttonview';import{BalloonPanelView as _0x36c940,BodyCollection as _0x2396a1}from'ckeditor5/src/ui';import{CKEditorError as _0x104d03,DomEmitterMixin as _0x460f8b,keyCodes as _0x23450c,Collection as _0x3ef67f}from'ckeditor5/src/utils';import'../../theme/sidebar-narrow.css';import{debounce as _0x4d5608}from'lodash-es';import _0x25c14e from'./editorannotations';export default class s extends _0x8e223d{static get['requires'](){return[_0x20dc59,_0x45c244];}static get[_0x234e('0xb')](){return _0x234e('0x3e');}constructor(_0xb76fd2){super(_0xb76fd2),this[_0x234e('0x54')]=!0x1,this[_0x234e('0x26')]=new Set(),this['_domEmitter']=Object['create'](_0x460f8b),this[_0x234e('0x50')]=new Map(),this[_0x234e('0x44')](_0x234e('0x4e'),null),this[_0x234e('0x48')]=null,this[_0x234e('0x24')]=[],this[_0x234e('0x34')]=new _0x3ef67f(),this['_refreshPositioningDebounced']=_0x4d5608(()=>{this[_0x234e('0x41')]();},0xfa,{'leading':!0x1});}[_0x234e('0x3d')](){this[_0x234e('0x4a')][_0x234e('0x3')][_0x234e('0xd')](_0x45c244)[_0x234e('0x32')]('narrowSidebar',this),this[_0x234e('0x2e')]=new _0x2396a1(this[_0x234e('0x4a')][_0x234e('0x10')]),this[_0x234e('0x12')]=new _0x36c940(this[_0x234e('0x4a')]['locale']),this[_0x234e('0x2e')][_0x234e('0x7')](),this[_0x234e('0x2e')][_0x234e('0x59')](this['balloonPanelView']);}['attach'](_0x47671d){this['annotations']=_0x47671d;const _0x47fa88=this[_0x234e('0x4a')][_0x234e('0x3')][_0x234e('0xd')](_0x20dc59),_0x5ec386=this['balloonPanelView'];if(_0x47fa88['_annotations']=_0x47671d,this[_0x234e('0x54')])throw new _0x104d03('narrowsidebar-attach-already-attached',this);this[_0x234e('0x54')]=!0x0,this[_0x234e('0x27')](_0x47fa88,_0x234e('0x38'),()=>{this[_0x234e('0x5')](),this[_0x234e('0x27')](_0x47fa88,_0x234e('0x11'),_0x5bfabd=>{_0x5bfabd[_0x234e('0x42')](),this[_0x234e('0x9')](_0x47671d);});}),_0x47fa88['_attachToContainer']({'viewClass':_0x234e('0xe'),'spaceBetweenItems':0x5});const _0x2a1b99=_0x3ca74d=>{const _0x542356=new _0x1981f7(this[_0x234e('0x4a')][_0x234e('0x10')]);_0x47fa88[_0x234e('0x15')](_0x3ca74d,_0x542356),this[_0x234e('0x50')][_0x234e('0x44')](_0x3ca74d,_0x542356),_0x542356[_0x234e('0x40')](_0x234e('0x45'),_0x234e('0x4f'),_0x234e('0xa'))['to'](_0x3ca74d['view'],_0x234e('0x45'),'type',_0x234e('0x2d')),_0x542356['on'](_0x234e('0x5a'),()=>{this['_manuallyClosedAnnotationViews'][_0x234e('0x1b')](),_0x5ec386[_0x234e('0x25')][_0x234e('0x30')]!==_0x3ca74d['view']?(this['_showBalloon'](_0x3ca74d),_0x3ca74d[_0x234e('0x39')]['element'][_0x234e('0x51')](),this[_0x234e('0x2a')](_0x3ca74d)):this['setActiveAnnotation'](null);});};for(const _0x1f3dc2 of _0x47671d)_0x2a1b99(_0x1f3dc2);this[_0x234e('0x27')](_0x47671d,'add',(_0xddfd56,_0x4fce26)=>{_0x2a1b99(_0x4fce26);}),this[_0x234e('0x27')](_0x47671d,_0x234e('0x58'),(_0x428c5c,_0x16c531,_0x20455b)=>{this[_0x234e('0x50')][_0x234e('0xd')](_0x16c531)[_0x234e('0x2f')](),this[_0x234e('0x50')][_0x234e('0x19')](_0x16c531),_0x47fa88['rearrange']({'removedAnnotation':_0x16c531,'previousAnnotation':_0x47671d[_0x234e('0xd')](_0x20455b-0x1),'nextAnnotation':_0x47671d[_0x234e('0xd')](_0x20455b+0x1)}),_0x16c531===this['activeAnnotation']&&this[_0x234e('0x2a')](null);},{'priority':_0x234e('0x1')}),this['listenTo'](_0x47671d,_0x234e('0x51'),(_0x3774b2,_0xa097e6)=>{this[_0x234e('0x2a')](_0xa097e6);}),this[_0x234e('0x27')](_0x47671d,_0x234e('0x35'),()=>{this[_0x234e('0x2a')](null);}),this['_domEmitter'][_0x234e('0x27')](document,'keydown',(_0x24694b,_0x29282b)=>{_0x29282b[_0x234e('0x2c')]===_0x23450c[_0x234e('0x1d')]&&_0x5ec386[_0x234e('0x6')]&&(this[_0x234e('0x26')]['add'](_0x5ec386[_0x234e('0x25')][_0x234e('0x30')]),this[_0x234e('0x1a')](),_0x29282b[_0x234e('0x21')](),_0x29282b['preventDefault']());}),this['_domEmitter']['listenTo'](document,_0x234e('0x36'),(_0xaa02e8,_0x59084a)=>{const _0x2fb09b=_0x59084a[_0x234e('0x3a')];_0x5ec386['isVisible']&&_0x5ec386[_0x234e('0x31')][_0x234e('0x46')](_0x2fb09b)||_0x47fa88[_0x234e('0x39')][_0x234e('0x31')][_0x234e('0x46')](_0x2fb09b)||_0xaa02e8[_0x234e('0x8')]||(this[_0x234e('0x26')][_0x234e('0x1b')](),this[_0x234e('0x1a')](),this[_0x234e('0x2a')](null));});const _0x27f678=this[_0x234e('0x4a')]instanceof _0x1e70b5?this[_0x234e('0x4a')][_0x234e('0x56')]:new _0x3ef67f([this['context']]);for(const _0x93c950 of _0x27f678)this[_0x234e('0x57')](_0x93c950);this[_0x234e('0x27')](_0x27f678,_0x234e('0x59'),(_0x13fa91,_0x4e8963)=>{this['listenTo'](_0x4e8963,_0x234e('0x4c'),()=>{this[_0x234e('0x57')](_0x4e8963);});}),this[_0x234e('0x27')](_0x27f678,_0x234e('0x58'),(_0xe8a017,_0x2f4de5)=>{_0x2f4de5['plugins'][_0x234e('0x22')](_0x234e('0x13'))&&this[_0x234e('0x16')](_0x2f4de5[_0x234e('0x3')][_0x234e('0xd')]('EditorAnnotations'));}),window['addEventListener'](_0x234e('0x1f'),this[_0x234e('0xc')]),this[_0x234e('0x41')]();}[_0x234e('0x2a')](_0x360ef9){if(_0x360ef9===this[_0x234e('0x4e')])return;const _0x1e8fec=this[_0x234e('0x4a')][_0x234e('0x3')][_0x234e('0xd')](_0x20dc59);if(_0x1e8fec[_0x234e('0x4b')]({'blurredAnnotation':this[_0x234e('0x4e')],'activatedAnnotation':_0x360ef9,'disableAnimationOnActivatedAnnotation':!0x0}),_0x360ef9)_0x1e8fec[_0x234e('0x29')](_0x360ef9)?this[_0x234e('0x28')](_0x360ef9):this[_0x234e('0x1a')]();else this[_0x234e('0x1a')]();this[_0x234e('0x4e')]=_0x360ef9;}[_0x234e('0x5')](){if(!this[_0x234e('0x54')])throw new _0x104d03(_0x234e('0x14'),this);this[_0x234e('0x2a')](null);const _0x3362ac=this[_0x234e('0x4a')][_0x234e('0x3')]['get'](_0x20dc59);this[_0x234e('0x1a')](),Array[_0x234e('0x49')](this[_0x234e('0x50')][_0x234e('0x1e')](),_0x38fb09=>_0x38fb09[_0x234e('0x2f')]()),this[_0x234e('0x50')]['clear'](),_0x3362ac[_0x234e('0x3f')](this[_0x234e('0x48')]),this['stopListening'](),this[_0x234e('0x33')][_0x234e('0x43')](),this['context']instanceof _0x1e70b5&&this[_0x234e('0x43')](this[_0x234e('0x4a')][_0x234e('0x56')]);for(const _0x375700 of Array['from'](this['_editorAnnotations']))this[_0x234e('0x16')](_0x375700);window[_0x234e('0x17')](_0x234e('0x1f'),this['_refreshPositioningDebounced']),this[_0x234e('0xc')][_0x234e('0x1c')](),this[_0x234e('0x24')]=[],this[_0x234e('0x54')]=!0x1,this[_0x234e('0x48')]=null;}['destroy'](){this[_0x234e('0x54')]&&this[_0x234e('0x5')](),this['bodyCollection']['detachFromDom']();}['_integrateWithEditorAnnotations'](_0x48816c){const _0x24f04e=_0x48816c[_0x234e('0x3')]['get'](_0x25c14e),_0x3ca5c8=this[_0x234e('0x4a')][_0x234e('0x3')]['get'](_0x20dc59),_0x5d1a8c=this['annotations'],_0x32ecd0=this[_0x234e('0x12')],_0x2b0fdb=()=>{const _0x55fd55=_0x24f04e[_0x234e('0x3c')]({'annotations':this[_0x234e('0x48')],'activeAnnotation':this[_0x234e('0x4e')]});this[_0x234e('0x47')](_0x55fd55),this[_0x234e('0x2a')](_0x55fd55[0x0]||null);};this[_0x234e('0x27')](_0x24f04e,'refresh',_0x2b0fdb),this[_0x234e('0x27')](_0x24f04e,_0x234e('0x35'),(_0x3f6ab2,{isAnnotationTracked:_0x55184a})=>{this['activeAnnotation']&&_0x55184a(this[_0x234e('0x4e')])&&(this[_0x234e('0x47')]([]),this[_0x234e('0x2a')](null));}),this[_0x234e('0x27')](_0x24f04e,'uiUpdate',()=>{this[_0x234e('0xc')]();}),this['listenTo'](_0x5d1a8c,_0x234e('0x35'),_0xd933ad=>{_0x24f04e['hasDomSelection']()&&_0xd933ad[_0x234e('0x2')]();},{'priority':_0x234e('0x0')}),this['listenTo'](this[_0x234e('0x33')],'mousedown',(_0x4c6f64,_0x5b140f)=>{const _0xf5ca77=_0x5b140f[_0x234e('0x3a')];_0x32ecd0[_0x234e('0x6')]&&_0x32ecd0['element'][_0x234e('0x46')](_0xf5ca77)||_0x3ca5c8[_0x234e('0x39')][_0x234e('0x31')]['contains'](_0xf5ca77)||this[_0x234e('0x4e')]&&_0x24f04e[_0x234e('0x55')]()&&(_0x2b0fdb(),_0x4c6f64[_0x234e('0x8')]=!0x0);},{'priority':_0x234e('0x0')}),this['_editorAnnotations'][_0x234e('0x59')](_0x24f04e);}[_0x234e('0x16')](_0xa11270){_0xa11270&&(this[_0x234e('0x43')](_0xa11270),this[_0x234e('0x34')]['remove'](_0xa11270));}['_setSelectedAnnotations'](_0x23f557){for(const _0x5116bd of this['_selectedAnnotations'])_0x23f557[_0x234e('0x37')](_0x5116bd)||this[_0x234e('0x26')][_0x234e('0x19')](_0x5116bd['view']);this[_0x234e('0x24')]=_0x23f557;}[_0x234e('0x41')](){const _0x37081e=this[_0x234e('0x12')];this[_0x234e('0x48')][_0x234e('0x20')](),_0x37081e[_0x234e('0x6')]&&this['_updateBalloonPosition']();}[_0x234e('0x28')](_0x4aefa8){if(this[_0x234e('0x26')]['has'](_0x4aefa8['view']))return;const _0xe2ca64=this[_0x234e('0x12')][_0x234e('0x25')][_0x234e('0x30')];_0xe2ca64!==_0x4aefa8[_0x234e('0x39')]?(_0xe2ca64&&this['_detachListeners'](_0xe2ca64),this['_attachListeners'](_0x4aefa8[_0x234e('0x39')]),this['balloonPanelView']['content'][_0x234e('0x1b')](),this[_0x234e('0x12')][_0x234e('0x25')]['add'](_0x4aefa8[_0x234e('0x39')]),this[_0x234e('0x3b')]()):this[_0x234e('0x3b')]();}['_updateBalloonPosition'](){const _0x32156f=this[_0x234e('0x12')]['content'][_0x234e('0x30')],_0x26c391=_0x32156f&&this['annotations']['getByView'](_0x32156f);if(!_0x26c391||!this[_0x234e('0x50')][_0x234e('0x22')](_0x26c391))return;const _0x1af329=this[_0x234e('0x50')][_0x234e('0xd')](_0x26c391)[_0x234e('0x31')],_0x5d5cb4=function(){const _0x298be3=_0x36c940['defaultPositions'];return[_0x298be3[_0x234e('0x52')],_0x298be3[_0x234e('0x18')],_0x298be3[_0x234e('0x23')],_0x298be3['northArrowSouth'],_0x298be3['southArrowNorthWest'],_0x298be3['northArrowSouthWest']];}();this[_0x234e('0x12')]['pin']({'target':_0x1af329,'positions':_0x5d5cb4});}[_0x234e('0x1a')](){const _0x28958a=this[_0x234e('0x12')],_0x279daf=_0x28958a[_0x234e('0x25')][_0x234e('0x30')];_0x279daf&&(this[_0x234e('0x4')](_0x279daf),_0x28958a[_0x234e('0x2b')](),_0x28958a[_0x234e('0x25')][_0x234e('0x1b')]());}[_0x234e('0x53')](_0x185182){this['listenTo'](_0x185182,_0x234e('0xf'),()=>this[_0x234e('0x3b')]()),this[_0x234e('0x27')](_0x185182,_0x234e('0x4d'),(_0x195a81,_0x2a29ce)=>{this[_0x234e('0x26')][_0x234e('0x59')](_0x185182),this[_0x234e('0x1a')](),_0x2a29ce();});}[_0x234e('0x4')](_0x40f1a0){this[_0x234e('0x43')](_0x40f1a0);}}