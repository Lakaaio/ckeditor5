/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x52a0=['resolvedBy','commentUpdated','_handleRemoveCommentModel','resolved','maxThreadTotalWeight','commentViews','_shouldCollapse','focus','insert','maxCommentsWhenCollapsed','resolvedCommentView','add','authoredAt','removeComment','_handleInfoComment','editorConfig','visibleViews','_config','refreshVisibleViews','length','_collapsedCommentsView','locale','Marked\x20as\x20resolved','ck-thread__comments','destroy','remove','hasDirtyComment','_updateHasDirtyComment','change:isActive','isResolved','listenTo','_handleNewCommentModel','CommentView','delete','weight','_findOptimalIndex','comments','change:isResolved','_model','isActive','get','createCollection','equal','isEditMode','count','from','change:hasDirtyComment','_rearrangeCollapse','collapse','_calculatePosition','stopListening','delegate','maxCommentCharsWhenCollapsed','set'];(function(_0x36047f,_0x52a069){const _0x4b2e6e=function(_0x57e9fd){while(--_0x57e9fd){_0x36047f['push'](_0x36047f['shift']());}};_0x4b2e6e(++_0x52a069);}(_0x52a0,0x147));const _0x4b2e=function(_0x36047f,_0x52a069){_0x36047f=_0x36047f-0x0;let _0x4b2e6e=_0x52a0[_0x36047f];return _0x4b2e6e;};import{View as _0x5fc3da}from'ckeditor5/src/ui';import{diff as _0x3f5fd9,Collection as _0x1df76b}from'ckeditor5/src/utils';import{getTranslation as _0xd46926}from'../../../utils/common-translations';import _0x4192ea from'./collapsedcommentsview';export default class wt extends _0x5fc3da{constructor(_0x4129d8,_0x420ba9,_0x4e9201){super(_0x4129d8),this['set'](_0x4b2e('0x17'),!0x1),this[_0x4b2e('0x32')](_0x4b2e('0x10'),_0x420ba9[_0x4b2e('0x21')][_0x4b2e('0x10')]),this[_0x4b2e('0x32')](_0x4b2e('0x24'),!0x1),this[_0x4b2e('0x23')]=_0x420ba9,this['_config']=_0x4e9201,this[_0x4b2e('0x2')]=this[_0x4b2e('0x26')](),this[_0x4b2e('0xd')]=this['createCollection'](),this[_0x4b2e('0x7')]=null,this['_collapsedCommentsView']=new _0x4192ea(_0x4129d8),this['_collapsedCommentsView']['bind'](_0x4b2e('0x29'))['to'](this,'length',_0x481519=>_0x481519-this['_config'][_0x4b2e('0x6')]);for(const _0xc70bac of _0x420ba9['comments'])this['_handleNewCommentModel'](_0xc70bac);this['_handleInfoComment'](),this[_0x4b2e('0x1b')](_0x420ba9[_0x4b2e('0x21')],_0x4b2e('0x8'),(_0x4bfa02,_0x212641)=>{const _0x2bbf15=this[_0x4b2e('0x2e')](_0x212641);this[_0x4b2e('0x10')]++,this[_0x4b2e('0x1c')](_0x212641,_0x2bbf15),this['refreshVisibleViews']();}),this[_0x4b2e('0x1b')](_0x420ba9[_0x4b2e('0x21')],_0x4b2e('0x16'),(_0x2edefa,_0x5e0be2)=>{this[_0x4b2e('0x10')]--,this[_0x4b2e('0x35')](_0x5e0be2),this[_0x4b2e('0xf')]();}),this[_0x4b2e('0x1b')](_0x420ba9,_0x4b2e('0x34'),()=>this['refreshVisibleViews']()),this[_0x4b2e('0x1b')](_0x420ba9,_0x4b2e('0x22'),()=>this[_0x4b2e('0xb')]()),this['on'](_0x4b2e('0x19'),()=>this[_0x4b2e('0xf')]()),this['on'](_0x4b2e('0x2b'),()=>this[_0x4b2e('0xf')]()),this['setTemplate']({'tag':'ul','attributes':{'class':[_0x4b2e('0x14')]},'children':this[_0x4b2e('0xd')]});}get[_0x4b2e('0x3')](){return this[_0x4b2e('0x23')][_0x4b2e('0x1f')]>this[_0x4b2e('0xe')][_0x4b2e('0x1')]&&!this[_0x4b2e('0x24')]&&!this[_0x4b2e('0x17')];}['render'](){super['render'](),this['refreshVisibleViews']();}['focus'](){this['element'][_0x4b2e('0x4')]();}['destroy'](){this['_collapsedCommentsView'][_0x4b2e('0x15')]();for(const _0x2ea870 of this[_0x4b2e('0x2')])_0x2ea870[_0x4b2e('0x15')]();super['destroy']();}['refreshVisibleViews'](){this[_0x4b2e('0x3')]?this['_rearrangeCollapse']():this['_rearrangeExpand']();}[_0x4b2e('0x1c')](_0xd7f182,_0x248d2b){const _0x144e90=new this[(_0x4b2e('0xe'))][(_0x4b2e('0x1d'))](this[_0x4b2e('0x12')],_0xd7f182,{'maxCommentCharsWhenCollapsed':this['_config'][_0x4b2e('0x31')],'formatDateTime':this[_0x4b2e('0xe')]['formatDateTime'],'editorConfig':this[_0x4b2e('0xe')][_0x4b2e('0xc')]});_0x144e90['viewUid']=_0xd7f182['id'],_0x144e90[_0x4b2e('0x30')](_0x4b2e('0xa'))['to'](this),_0x144e90[_0x4b2e('0x30')]('updateComment')['to'](this),_0x144e90[_0x4b2e('0x30')]('resolveCommentThread')['to'](this),this[_0x4b2e('0x1b')](_0x144e90,'change:isEditMode',()=>this[_0x4b2e('0x18')]()),this['commentViews'][_0x4b2e('0x8')](_0x144e90,_0x248d2b);}[_0x4b2e('0x2e')](_0xb52e2e){const _0x2a7172=this[_0x4b2e('0x23')][_0x4b2e('0x20')](_0xb52e2e);return this[_0x4b2e('0x7')]?this['resolvedCommentView'][_0x4b2e('0x9')]>_0xb52e2e[_0x4b2e('0x9')]?_0x2a7172-0x1:_0x2a7172:_0x2a7172-0x1;}[_0x4b2e('0xb')](){if(this[_0x4b2e('0x23')][_0x4b2e('0x1a')]){const _0x555b3a={'id':_0x4b2e('0x0'),'author':this['_model'][_0x4b2e('0x33')],'authoredAt':this['_model']['resolvedAt'],'content':_0xd46926(this[_0x4b2e('0x12')],_0x4b2e('0x13')),'attributes':{}};this[_0x4b2e('0x7')]=new this['_config'][(_0x4b2e('0x1d'))](this[_0x4b2e('0x12')],_0x555b3a,{'maxCommentCharsWhenCollapsed':this['_config']['maxCommentCharsWhenCollapsed'],'formatDateTime':this[_0x4b2e('0xe')]['formatDateTime'],'editorConfig':this[_0x4b2e('0xe')][_0x4b2e('0xc')],'isSystemComment':!0x0}),this['commentViews']['add'](this[_0x4b2e('0x7')],this[_0x4b2e('0x23')][_0x4b2e('0x20')](_0x555b3a));}else this['resolvedCommentView']&&(this[_0x4b2e('0x2')][_0x4b2e('0x16')](this[_0x4b2e('0x7')]),this[_0x4b2e('0x7')][_0x4b2e('0x15')](),this[_0x4b2e('0x7')]=null);this[_0x4b2e('0xf')]();}[_0x4b2e('0x35')](_0x3b2acd){const _0x1c28c2=this[_0x4b2e('0x2')][_0x4b2e('0x16')](_0x3b2acd['id']);this[_0x4b2e('0x2f')](_0x1c28c2),_0x1c28c2[_0x4b2e('0x28')]&&this[_0x4b2e('0x18')](),_0x1c28c2['destroy']();}[_0x4b2e('0x18')](){this[_0x4b2e('0x17')]=Array[_0x4b2e('0x2a')](this[_0x4b2e('0x2')])['some'](_0xa6a8b8=>_0xa6a8b8[_0x4b2e('0x28')]);}[_0x4b2e('0x2c')](){const _0x10f27a=function(_0x56e64b){const _0x56916b=new _0x1df76b();for(const _0x48f04a of _0x56e64b)_0x56916b[_0x4b2e('0x8')](_0x48f04a);return _0x56916b;}(this['commentViews']),_0x228c54=this[_0x4b2e('0x11')]['count'];for(let _0x208608=0x1;_0x208608<=_0x228c54;_0x208608++)_0x10f27a[_0x4b2e('0x16')](0x1);for(const _0x36fb0e of _0x10f27a)_0x36fb0e[_0x4b2e('0x2d')]();_0x228c54>0x0&&_0x10f27a[_0x4b2e('0x8')](this[_0x4b2e('0x11')],0x1),ss(_0x3f5fd9(Array['from'](this[_0x4b2e('0xd')]),Array['from'](_0x10f27a)),this[_0x4b2e('0xd')],_0x10f27a);}['_rearrangeExpand'](){ss(_0x3f5fd9(Array['from'](this[_0x4b2e('0xd')]),Array['from'](this['commentViews'])),this[_0x4b2e('0xd')],this[_0x4b2e('0x2')]);for(const _0x1f670b of this[_0x4b2e('0xd')])_0x1f670b['expand']();}}function ss(_0x3f901c,_0x320cdb,_0x32597f){let _0x5743e0=0x0;for(const _0x26cd88 of _0x3f901c)switch(_0x26cd88){case _0x4b2e('0x5'):_0x320cdb['add'](_0x32597f[_0x4b2e('0x25')](_0x5743e0),_0x5743e0),_0x5743e0++;break;case _0x4b2e('0x1e'):_0x320cdb[_0x4b2e('0x16')](_0x5743e0);break;case _0x4b2e('0x27'):_0x5743e0++;}}