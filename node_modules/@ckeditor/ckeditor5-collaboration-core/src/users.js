/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x2641=['getUser','requires','getSelectionClass','_getInitial','length','licenseKeyTrial','licenseKeyValid','getMarkerClass','licenseKeyTrialLimit:operations','config','decorate','get','getBackgroundColorClass','users-me-missing-user','_lastColor','users-add-duplicated-id','isAnonymous','users-add-invalid-id','Anonymous','avatar','licenseKeyTrialLimit:revisions','trim','_myId','split','users','_locale','_getNextColor','init','trial-license-key-reached-limit-revisions','You\x20are\x20using\x20the\x20trial\x20version\x20of\x20CKEditor\x205\x20collaboration\x20plugin\x20with\x20limited\x20usage.\x20Make\x20sure\x20you\x20will\x20not\x20use\x20it\x20in\x20the\x20production\x20environment.','getOperationAuthor','ck-user__marker--','invalid-license-key','destroy','pluginName','addUser','defineMe','licenseKey','has','licenseKeyInvalid','includes','ck-user__selection--','_id','info','string','ck-user__bg-color--','context','Users','users.colorsCount','color','charAt','_isAnonymous','_addAnonymousUser','trial-license-key-reached-limit-time','_licenseKeyCheckInterval','name','toUpperCase','anonymous-user','users.anonymousUserId','licenseKeyTrialLimit:time'];(function(_0x2c2f9f,_0x264194){const _0x2e89b2=function(_0x34d99d){while(--_0x34d99d){_0x2c2f9f['push'](_0x2c2f9f['shift']());}};_0x2e89b2(++_0x264194);}(_0x2641,0x6f));const _0x2e89=function(_0x2c2f9f,_0x264194){_0x2c2f9f=_0x2c2f9f-0x0;let _0x2e89b2=_0x2641[_0x2c2f9f];return _0x2e89b2;};import{ContextPlugin as _0x38de3c}from'ckeditor5/src/core';import{Collection as _0xb6d25a,CKEditorError as _0x21035b}from'ckeditor5/src/utils';import _0x5503ea from'./permissions';import{getTranslation as _0x18f740}from'./utils/common-translations';import'../theme/usercolors.css';export default class l extends _0x38de3c{static get[_0x2e89('0x2b')](){return _0x2e89('0x38');}static get[_0x2e89('0xa')](){return[_0x5503ea];}constructor(_0x12af95){super(_0x12af95),this[_0x2e89('0x37')][_0x2e89('0x12')]['define']('users.anonymousUserId',_0x2e89('0x6')),this[_0x2e89('0x37')][_0x2e89('0x12')]['define'](_0x2e89('0x39'),0x8),this['users']=new _0xb6d25a(),this[_0x2e89('0x22')]=_0x12af95['locale'],this['_licenseKeyCheckInterval']=null,this[_0x2e89('0x17')]=0x0,this[_0x2e89('0x1f')]=null,this[_0x2e89('0x13')](_0x2e89('0x27'));}[_0x2e89('0x24')](){const _0x2e7bbf=this[_0x2e89('0x37')];this['licenseKey']=_0x2e7bbf['config'][_0x2e89('0x14')](_0x2e89('0x2e'));const _0xa63572=[_0x2e89('0xe'),_0x2e89('0x30'),_0x2e89('0xf'),_0x2e89('0x11'),_0x2e89('0x8'),'licenseKeyTrialLimit:revisions'];this[_0x2e89('0x3')]=setInterval(()=>{let _0x43b213;for(const _0x19315f in _0x2e7bbf){const _0x22a306=_0x2e7bbf[_0x19315f];if(_0xa63572[_0x2e89('0x31')](_0x22a306)){delete _0x2e7bbf[_0x19315f],_0x43b213=_0x22a306;break;}}if(_0x2e89('0x30')===_0x43b213)throw clearInterval(this[_0x2e89('0x3')]),new _0x21035b(_0x2e89('0x29'),null);if(_0x2e89('0xe')===_0x43b213&&console[_0x2e89('0x34')](_0x2e89('0x26')),'licenseKeyTrialLimit:operations'===_0x43b213)throw clearInterval(this[_0x2e89('0x3')]),new _0x21035b('trial-license-key-reached-limit-changes',null);if(_0x2e89('0x8')===_0x43b213)throw clearInterval(this[_0x2e89('0x3')]),new _0x21035b(_0x2e89('0x2'),null);if(_0x2e89('0x1d')===_0x43b213)throw clearInterval(this[_0x2e89('0x3')]),new _0x21035b(_0x2e89('0x25'),null);'licenseKeyValid'===_0x43b213&&clearInterval(this['_licenseKeyCheckInterval']);},0x3e8),this[_0x2e89('0x1')]();}get['me'](){return null==this[_0x2e89('0x1f')]?null:this['getUser'](this['_myId']);}[_0x2e89('0x2c')]({id:_0x393843,name:_0x3de0ba,..._0x2ff19e}){if(!_0x393843||_0x2e89('0x35')!=typeof _0x393843)throw new _0x21035b(_0x2e89('0x1a'));if(this['users'][_0x2e89('0x2f')](_0x393843))throw new _0x21035b(_0x2e89('0x18'),null,{'id':_0x393843});const _0x351d27={..._0x2ff19e,'id':_0x393843,'name':a(this[_0x2e89('0x22')],_0x3de0ba),'color':this[_0x2e89('0x23')]()};_0x351d27[_0x2e89('0x4')]=a(this[_0x2e89('0x22')],_0x351d27[_0x2e89('0x4')]);const _0x446a55=new User(_0x351d27);return this[_0x2e89('0x21')]['add'](_0x446a55),_0x446a55;}[_0x2e89('0x9')](_0x131015){return this[_0x2e89('0x21')][_0x2e89('0x14')](_0x131015);}['useAnonymousUser'](){const _0x18f1a1=this['context'][_0x2e89('0x12')][_0x2e89('0x14')](_0x2e89('0x7'));this['_myId']||this[_0x2e89('0x2d')](_0x18f1a1);}[_0x2e89('0x2d')](_0x56e78e){if(this['_myId'])throw new _0x21035b('users-me-already-defined',null);if(!this[_0x2e89('0x9')](_0x56e78e))throw new _0x21035b(_0x2e89('0x16'),null);this['_myId']=_0x56e78e;}[_0x2e89('0x27')](){return this['me'];}[_0x2e89('0x2a')](){super[_0x2e89('0x2a')](),clearInterval(this[_0x2e89('0x3')]);}[_0x2e89('0x23')](){const _0x5d3912=this['context']['config'][_0x2e89('0x14')]('users.colorsCount');return this[_0x2e89('0x17')]>=_0x5d3912&&(this[_0x2e89('0x17')]=0x0),new u(this['_lastColor']++);}[_0x2e89('0x1')](){const _0x1657ec=this[_0x2e89('0x37')][_0x2e89('0x12')][_0x2e89('0x14')](_0x2e89('0x7'));this[_0x2e89('0x2c')]({'id':_0x1657ec,'name':_0x18f740(this[_0x2e89('0x22')],'Anonymous')})[_0x2e89('0x0')]=!0x0;}}export class User{constructor(_0x280c25){this['id']=_0x280c25['id'],this[_0x2e89('0x3a')]=_0x280c25[_0x2e89('0x3a')],this[_0x2e89('0x4')]=_0x280c25[_0x2e89('0x4')],this[_0x2e89('0x1c')]=_0x280c25[_0x2e89('0x1c')],this[_0x2e89('0x0')]=!0x1;}get[_0x2e89('0x19')](){return this[_0x2e89('0x0')];}get['initials'](){const _0x5b3788=this[_0x2e89('0x4')][_0x2e89('0x20')]('\x20');return 0x1===_0x5b3788[_0x2e89('0xd')]?this[_0x2e89('0xc')](_0x5b3788[0x0]):this[_0x2e89('0xc')](_0x5b3788[0x0])+this[_0x2e89('0xc')](_0x5b3788[_0x5b3788[_0x2e89('0xd')]-0x1]);}[_0x2e89('0xc')](_0x406e3d){return _0x406e3d[_0x2e89('0x3b')](0x0)[_0x2e89('0x5')]();}}function a(_0xbc9287,_0x36c4e8=''){return''==(_0x36c4e8=_0x36c4e8[_0x2e89('0x1e')]())?_0x18f740(_0xbc9287,_0x2e89('0x1b')):_0x36c4e8;}class u{constructor(_0x43ed77){this[_0x2e89('0x33')]=_0x43ed77;}[_0x2e89('0x15')](){return _0x2e89('0x36')+this[_0x2e89('0x33')];}[_0x2e89('0xb')](){return _0x2e89('0x32')+this[_0x2e89('0x33')];}[_0x2e89('0x10')](){return _0x2e89('0x28')+this[_0x2e89('0x33')];}}