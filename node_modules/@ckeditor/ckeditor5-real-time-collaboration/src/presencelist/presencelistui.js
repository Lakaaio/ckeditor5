/*
 *             Copyright (c) 2016 - 2023, CKSource Holding sp. z o.o. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x4e8d=['appendChild','bodyCollection','inlineListView','requires','_handleUserRemove','hideDropdown','using','presenceList.container','isVisible','isHidden','from','execute','isRendered','_handleUserAdd','render','allConnectedUsers','view','_createView','presencelist-missing-container','content','items','unpin','usersCount','isCollapsed','bindTo','presenceList','locale','presenceDropdownView','onClick','counterView','add','length','presenceList.collapseAt','presencelist-collapseat-invalid-format','context','detachFromDom','define','init','get','plugins','destroy','balloonPanelView','remove','class','element','lastConnectedUsers','showDropdown','_allConnectedUsers','config','bind'];(function(_0x557af7,_0x4e8d09){const _0x4fe7cc=function(_0x4db1b7){while(--_0x4db1b7){_0x557af7['push'](_0x557af7['shift']());}};_0x4fe7cc(++_0x4e8d09);}(_0x4e8d,0x1cb));const _0x4fe7=function(_0x557af7,_0x4e8d09){_0x557af7=_0x557af7-0x0;let _0x4fe7cc=_0x4e8d[_0x557af7];return _0x4fe7cc;};import{ContextPlugin as _0x59e933}from'ckeditor5/src/core';import{CKEditorError as _0xc4e4d1,Collection as _0x209c77}from'ckeditor5/src/utils';import{clickOutsideHandler as _0x1dd6f3,BodyCollection as _0x26ef52,BalloonPanelView as _0x2bd6d6}from'ckeditor5/src/ui';import{isElement as _0x45346c}from'lodash-es';import _0x5c6bde from'../realtimecollaborativeediting/sessions';import _0x919e8d from'./view/presencelistview';import _0x3f7677 from'./view/presencedropdownlistview';import _0x20ec11 from'./view/presencedropdownlistitemview';import _0x14e3d2 from'./view/presenceinlinelistitemview';export default class i extends _0x59e933{constructor(_0x3936db){super(_0x3936db),this[_0x4fe7('0x19')][_0x4fe7('0x27')][_0x4fe7('0x1b')]('presenceList',{'collapseAt':0x6});const _0x304a38=_0x3936db[_0x4fe7('0x27')][_0x4fe7('0x1d')](_0x4fe7('0x17'));if('number'!=typeof _0x304a38)throw new _0xc4e4d1(_0x4fe7('0x18'),this);if(_0x304a38<0x1)throw new _0xc4e4d1('presencelist-collapseat-invalid-format',this);this['_allConnectedUsers']=this[_0x4fe7('0x19')][_0x4fe7('0x1e')][_0x4fe7('0x1d')](_0x5c6bde)[_0x4fe7('0x6')],this['set'](_0x4fe7('0xd'),0x0),this[_0x4fe7('0x24')]=new _0x209c77(),this[_0x4fe7('0x20')]=new _0x2bd6d6(),this[_0x4fe7('0x20')][_0x4fe7('0x22')]='ck\x20ck-presence-list__balloon',this['view']=this[_0x4fe7('0x8')](),this[_0x4fe7('0x12')]=void 0x0;}static get[_0x4fe7('0x2c')](){return[_0x5c6bde];}[_0x4fe7('0x1c')](){for(const _0x3ae4a2 of this['_allConnectedUsers'])this[_0x4fe7('0x4')](_0x3ae4a2);this['listenTo'](this[_0x4fe7('0x26')],_0x4fe7('0x15'),(_0x4b9e5c,_0x365bf2)=>{this[_0x4fe7('0x4')](_0x365bf2);}),this['listenTo'](this[_0x4fe7('0x26')],'remove',(_0x20bf55,_0x1c905b)=>{this[_0x4fe7('0x2d')](_0x1c905b);});}['_createView'](){const _0x5c7603=this['context'],_0x2cf794=new _0x919e8d(this['context'][_0x4fe7('0x11')]),_0xa6eb60=this[_0x4fe7('0x20')];if(!_0x45346c(_0x5c7603[_0x4fe7('0x27')][_0x4fe7('0x1d')](_0x4fe7('0x30'))))throw new _0xc4e4d1(_0x4fe7('0x9'),this);return _0x2cf794[_0x4fe7('0x14')][_0x4fe7('0x28')](_0x4fe7('0xd'))['to'](this),_0x2cf794[_0x4fe7('0x28')]('isCollapsed')['to'](this,_0x4fe7('0xd'),_0x3b2963=>{const _0x5c1d7a=_0x3b2963>=_0x5c7603[_0x4fe7('0x27')][_0x4fe7('0x1d')]('presenceList.collapseAt');return _0x2cf794[_0x4fe7('0x14')][_0x4fe7('0x0')]=!(0x1==_0x3b2963||_0x5c1d7a),_0x5c1d7a||this[_0x4fe7('0x2e')](),_0x5c1d7a;}),_0x2cf794[_0x4fe7('0x2b')][_0x4fe7('0xb')][_0x4fe7('0xf')](this['lastConnectedUsers'])[_0x4fe7('0x2f')](_0x61af36=>{const _0x25ea93=_0x5c7603[_0x4fe7('0x27')][_0x4fe7('0x1d')](_0x4fe7('0x10')),_0x286d41=new _0x14e3d2(_0x5c7603[_0x4fe7('0x11')],_0x61af36,!!_0x25ea93[_0x4fe7('0x13')]);return _0x286d41['bind']('hasTooltip')['to'](_0x2cf794,'isCollapsed',_0x2a7b92=>!_0x2a7b92),_0x25ea93['onClick']&&this['listenTo'](_0x286d41,'execute',()=>{this[_0x4fe7('0x7')][_0x4fe7('0xe')]||_0x25ea93['onClick'](_0x61af36,_0x286d41[_0x4fe7('0x23')]);}),_0x286d41;}),this['listenTo'](_0x2cf794['inlineListView'],_0x4fe7('0x2'),()=>{this['presenceDropdownView']?this[_0x4fe7('0x2e')]():this['view'][_0x4fe7('0xe')]&&this[_0x4fe7('0x25')]();}),_0x2cf794[_0x4fe7('0x5')](),_0xa6eb60[_0x4fe7('0x5')](),_0x1dd6f3({'emitter':_0x2cf794,'activator':()=>_0xa6eb60[_0x4fe7('0x31')],'contextElements':[_0xa6eb60[_0x4fe7('0x23')],_0x2cf794[_0x4fe7('0x2b')][_0x4fe7('0x23')]],'callback':()=>this[_0x4fe7('0x2e')]()}),_0x5c7603[_0x4fe7('0x27')][_0x4fe7('0x1d')](_0x4fe7('0x30'))[_0x4fe7('0x29')](_0x2cf794[_0x4fe7('0x23')]),this[_0x4fe7('0x2a')]=new _0x26ef52(this[_0x4fe7('0x19')][_0x4fe7('0x11')]),this[_0x4fe7('0x2a')]['attachToDom'](),this[_0x4fe7('0x2a')][_0x4fe7('0x15')](_0xa6eb60),_0x2cf794;}[_0x4fe7('0x4')](_0x331010){this['usersCount']++,0x5==this[_0x4fe7('0x24')][_0x4fe7('0x16')]&&this['lastConnectedUsers']['remove'](0x0),this['lastConnectedUsers']['add'](_0x331010);}['_handleUserRemove'](_0x2e0d7e){if(this['usersCount']--,this[_0x4fe7('0x24')][_0x4fe7('0x1d')](_0x2e0d7e['id'])&&(this[_0x4fe7('0x24')][_0x4fe7('0x21')](_0x2e0d7e['id']),this['lastConnectedUsers']['length']<this[_0x4fe7('0xd')]))for(const _0x1e4c94 of Array[_0x4fe7('0x1')](this['_allConnectedUsers'])['reverse']())if(!this['lastConnectedUsers']['get'](_0x1e4c94['id']))return void this[_0x4fe7('0x24')][_0x4fe7('0x15')](_0x1e4c94,0x0);}[_0x4fe7('0x25')](){if(this[_0x4fe7('0x12')])return;this[_0x4fe7('0x12')]=new _0x3f7677(this['context'][_0x4fe7('0x11')]);const _0x3c8dd4=this[_0x4fe7('0x19')]['config']['get'](_0x4fe7('0x10'));this[_0x4fe7('0x12')][_0x4fe7('0xb')][_0x4fe7('0xf')](this['_allConnectedUsers'])[_0x4fe7('0x2f')](_0x491bd4=>{const _0x231895=new _0x20ec11(this[_0x4fe7('0x19')][_0x4fe7('0x11')],_0x491bd4,!!_0x3c8dd4[_0x4fe7('0x13')]);return _0x3c8dd4[_0x4fe7('0x13')]&&this['listenTo'](_0x231895,'execute',()=>{_0x3c8dd4[_0x4fe7('0x13')](_0x491bd4,_0x231895[_0x4fe7('0x23')]);}),_0x231895;}),this[_0x4fe7('0x20')][_0x4fe7('0xa')]['add'](this[_0x4fe7('0x12')]),this[_0x4fe7('0x20')]['pin']({'target':this[_0x4fe7('0x7')][_0x4fe7('0x2b')][_0x4fe7('0x23')]});}[_0x4fe7('0x2e')](){this[_0x4fe7('0x12')]&&(this[_0x4fe7('0x20')][_0x4fe7('0xc')](),this[_0x4fe7('0x20')][_0x4fe7('0xa')][_0x4fe7('0x21')](this[_0x4fe7('0x12')]),this['presenceDropdownView'][_0x4fe7('0x1f')](),this[_0x4fe7('0x12')]=void 0x0);}[_0x4fe7('0x1f')](){super[_0x4fe7('0x1f')](),this[_0x4fe7('0x7')]&&this[_0x4fe7('0x7')][_0x4fe7('0x3')]&&this[_0x4fe7('0x7')][_0x4fe7('0x1f')](),this[_0x4fe7('0x2a')]&&this[_0x4fe7('0x2a')][_0x4fe7('0x1a')]();}}