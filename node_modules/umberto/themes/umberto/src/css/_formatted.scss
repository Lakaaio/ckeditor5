// Copyright (c) 2017-2023, CKSource Holding sp. z o.o. All rights reserved.
// For licensing, see LICENSE.md or http://ckeditor.com/license

.formatted {
	// @include u-draw-baseline( 0 );

	p, ul, ol, blockquote, pre {
		@include u-baseline( 0 );
	}

	h1 {
		@include u-baseline( 4 );

		& + dl {
			margin-top: u-spacing( 0 );
		}

		@include u-responsive-mobile {
			font-size: 1.9em;
		}
	}

	dd {
		margin-bottom: u-spacing( 0 );
	}

	// temporary, should not be needed after typography redesign
	h1:first-of-type {
		$rhythm: map-get( $u-baseline-levels, 4 );
		width: 100%;

		padding-top: nth( $rhythm, 3 ) - 0.5em;
		margin-bottom: nth( $rhythm, 4 ) - 0.5em;

		& + h2 {
			padding-top: 0;
		}
	}

	h2 {
		@include u-baseline( 3 );
		padding-bottom: .2em;
		border-bottom: 1px solid u-color( 'separator' );
		font-weight: 400;

		@include u-responsive-mobile {
			font-size: 1.5em;
		}
	}

	h2:first-of-type {
		clear: both;
	}

	h3 {
		@include u-baseline( 2 );
		font-weight: 400;
	}

	h4 {
		@include u-baseline( 1 );
		@include u-baseline-margin( 2 );
		@include u-baseline-padding( 2 );
		font-weight: 400;
	}

	h5 {
		@include u-baseline( 0 );
		font-weight: 400;
	}

	.info-box {
		& > h2, & > h3, & > h4 {
			padding-top: 0;
		}
	}

	strong, b {
		font-weight: 600;
	}

	i, em {
		font-style: italic;
	}

	pre {
		overflow: hidden;
	}

	code {
		font-family: $u-font-face-mono;
		font-size: .866666em; // 13px
		padding: u-spacing( 2 );
	}

	:not( pre ) > code:not( .highlight ) {
		& {
			// It's a darker shade of u-color( 'background-hue' ) so it looks good in info-boxes.
			// See #230.
			background: rgba( 202, 205, 207, 0.3 );
			padding: u-spacing( -4 ) u-spacing( -3 );
			border-radius: 3px;
		}

		// See #223.
		&::after {
			// To reduce the width of that space to 0px.
			letter-spacing: -1em;
			content: "\00a0";
		}

		// See #223.
		&::before {
			// To reduce the width of that space to 0px.
			letter-spacing: -1em;
			content: "\00a0";
		}
	}

	a code:not( .highlight ) {
		color: u-color( 'link' );
	}

	.highlight {
		background: #2b2c26;
		color: #f8f8f2;

		a {
			color: u-color( 'text-invert' );
		}
	}

	.highlight code {
		background: none;
		padding: 0;
		font-size: 1em;
	}

	blockquote {
		border-left: 1px solid u-color( toggler );
		padding-left: 10px;
		padding-top: 0;
		font-style: italic;
	}

	kbd {
		display: inline-block;
		background: u-color( 'background-dark' );
		border: solid 1px u-border-color( 'background-hue', 5% );
		border-bottom-color: u-border-color( 'background-hue', -5% );
		box-shadow: inset 0 -1px 0  u-border-color( 'background-hue', -5% );
		font-family: $u-font-face-mono;
		font-size: .8em; // 12px;
		padding: u-spacing( -3 ) u-spacing( -2 );
		line-height: 1em;
		vertical-align: middle;
		border-radius: 3px;
	}

	ul, ol {
		margin-left: 2 * u-spacing( 2 );

		@include u-baseline-margin( 0 );

		@include u-responsive-mobile {
			margin-left: u-spacing( 2 );
		}
	}

	ul, ol {
		ul, ol {
			padding-top: 0;
			margin-bottom: 0;

			&:last-of-type {
				margin-bottom: math.div( u-spacing( 0 ), 3 );
			}
		}

		li {
			&:last-of-type {
				margin-bottom: 0;
			}
		}
	}

	p img {
		display: block;
		margin: u-spacing( 3 ) auto;
		box-sizing: content-box;
	}

	iframe:not( .cke_wysiwyg_frame ) {
		display: block;
		margin: u-spacing( 3 ) auto;
	}

	ol {
		list-style-type: decimal;
	}

	table {
		margin: u-spacing( 3 ) 0;
		width: 100%;

		/* See: #794. Long code or snippet without any white-space is breaking table. */
		code {
			word-break: break-word;
			white-space: normal;
		}
	}

	td, th {
		border: 1px solid u-border-color( 'background-dark', 20% );
		padding: 6px 12px;
	}

	th {
		font-weight: bold;
	}

	abbr {
		position: relative;
		cursor: default;
		text-decoration: none;
		border-bottom: 1px dotted #000;
	}

	abbr::before {
		content: attr(title);
		display: none;
		position: absolute;
		bottom: calc( -100% - 15px );
		left: 50%;
		transform: translateX( -50% );
		padding: 3px 5px;
		font-size: 0.9em;
		font-weight: bold;
		border-radius: 3px;
		color: #fff;
		background: black;
		white-space: nowrap;
	}

	abbr::after {
		content: '';
		display: none;
		position: absolute;
		bottom: -5px;
		left: 50%;
		transform: translateX( -50% );
		width: 0;
		height: 0;
		border-style: solid;
		border-width: 0 5px 5px 5px;
		border-color: transparent transparent #000 transparent;

	}

	abbr:hover::before,
	abbr:hover::after {
		display: block;
	}
}

/* See: https://github.com/ckeditor/ckeditor5/issues/1977. */
.formatted {
	[dir=rtl] {
		ul, ol {
			margin-left: 0;
			margin-right: 2 * u-spacing( 2 );

			@include u-responsive-mobile {
				margin-right: u-spacing( 2 );
			}
		}
	}
}
