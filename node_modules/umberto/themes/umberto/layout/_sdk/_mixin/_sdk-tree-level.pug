include ./_sdk-tree-item.pug

mixin sdkNavTreeLevel( section )
	-
		let dataArr = [].concat( section.categories || [] ).sort( ( a, b ) => ( a.title || a.name ).localeCompare( b.title || b.name ) );
		dataArr = dataArr.map( ( item, idx ) => {
			item.index = idx;
			return item;
		} );

		dataArr.sort( ( a, b ) => {
			if ( a.order === b.order ) {
				return a.index - b.index;
			} else {
				return a.order - b.order;
			}
		} );

	each group in dataArr
		li
			div.tree__item__wrapper
				span( class="tree__item--folder tree__item__text" ) #{ group.name }
			ul.tree__item-nested-list
				if group.categories
					+sdkNavTreeLevel( group )
				else
					- const pages = getPages( group.id );
					each page in pages
						+sdkNavTreeItem( page )
